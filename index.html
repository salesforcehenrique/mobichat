<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>temporario</title>
</head>
<body>
  <h1>tempor√°rio</h1>

  <script type="text/javascript">
    // üîß Dados do usu√°rio autenticado
    const preChatNomeDoUsuarioLogado = "RITA DA ITA";
    const preChatCPF = "12913603602";
    const preChatCodigoConta = "C-9";
    const preChatCodigoUsuario = "U-18110";

    function initEmbeddedMessaging() {
      try {
        // üåê Configura√ß√µes do Bootstrap
        embeddedservice_bootstrap.settings.language = 'pt_BR';

        // üöÄ Inicializa o chat (sem prechatConfig ou routingAttributes, pois o envio √© feito via API)
        embeddedservice_bootstrap.init(
          '00Dbe000002jTkf', // ORG_ID
          'Chat_Mobi',       // Deployment API Name
          'https://segimob--staging.sandbox.my.site.com/ESWChatMobi1764466409624', // Site Endpoint
          {
            scrt2URL: 'https://segimob--staging.sandbox.my.salesforce-scrt.com'
          }
        );
      } catch (err) {
        console.error("‚ùå Erro ao iniciar o chat v2:", err);
      }
    }

    // ‚úÖ Evento para indicar que est√° pronto
    window.addEventListener("onEmbeddedMessagingReady", function () {
      console.log("‚úÖ Chat V2 pronto. Enviando dados de pr√©-chat...");

      // üí¨ Envia os dados de pr√©-chat usando a API correta: setHiddenPrechatFields
      const preChatData = {
        preChatNomeDoUsuarioLogado: preChatNomeDoUsuarioLogado,
        preChatCPF: preChatCPF,
        preChatCodigoConta: preChatCodigoConta,
        preChatCodigoUsuario: preChatCodigoUsuario
      };

      if (window.embeddedservice_bootstrap && window.embeddedservice_bootstrap.prechatAPI && window.embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields) {
        window.embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields(preChatData);
        console.log("‚úÖ Dados de pr√©-chat enviados com sucesso:", preChatData);
      } else {
        console.error("‚ùå API setHiddenPrechatFields n√£o dispon√≠vel.");
      }
    });
  </script>

  <!-- üì¶ Bootstrap Script do Chat V2 -->
  <script
    type="text/javascript"
    src="https://segimob--staging.sandbox.my.site.com/ESWChatMobi1764466409624/assets/js/bootstrap.min.js"
    onload="initEmbeddedMessaging()">
  </script>
</body>
</html>
