<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Chat com Salesforce (v2)</title>
</head>
<body>
  <h1>P√°gina de Teste - Chat Salesforce v2</h1>
  <p>O chat ser√° carregado no canto inferior direito.</p>

  <script type="text/javascript">
    // Simulando dados do usu√°rio
    const preChatNomeDoUsuarioLogado = "Yatagan Farias";
    const preChatCPF = "123.456.189-10";
    const preChatCodigoConta = "C-9999";
    const preChatCodigoUsuario = "U-9999";

    // Definindo campos de pr√©-chat antes do init
    embeddedservice_bootstrap.settings = {
      prechatConfig: {
        hiddenFields: {
          preChatNomeDoUsuarioLogado: preChatNomeDoUsuarioLogado,
          preChatCPF: preChatCPF,
          preChatCodigoConta: preChatCodigoConta,
          preChatCodigoUsuario: preChatCodigoUsuario
        }
      },
      language: 'pt_BR'
    };

    // Listener opcional para depura√ß√£o (confirma√ß√£o visual)
    window.addEventListener("onEmbeddedMessagingReady", function () {
      console.log("‚úÖ Chat V2 pronto. Campos j√° foram definidos.");
      console.log("üì§ Campos enviados:", embeddedservice_bootstrap.prechatAPI.getHiddenPrechatFields());
    });

    // Inicializa o chat
    function initEmbeddedMessaging() {
      try {
        embeddedservice_bootstrap.init(
          '00Dbe000002jTkf', // ORG_ID
          'Chat_Mobi',       // Deployment Name
          'https://segimob--staging.sandbox.my.site.com/ESWChatMobi1764466409624',
          {
            scrt2URL: 'https://segimob--staging.sandbox.my.salesforce-scrt.com'
          }
        );
      } catch (err) {
        console.error("‚ùå Erro ao iniciar o chat v2:", err);
      }
    }
  </script>

  <!-- Bootstrap Script (carrega o chat e chama o init no onload) -->
  <script 
    type="text/javascript" 
    src="https://segimob--staging.sandbox.my.site.com/ESWChatMobi1764466409624/assets/js/bootstrap.min.js" 
    onload="initEmbeddedMessaging()">
  </script>
</body>
</html>
